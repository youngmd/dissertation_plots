datapath <- "~/gcc/Files_for_GCS_Database/n4594/"
rp = read.table(paste(datapath,'/radial_profile.dat',sep=''), col.names = cnames)
mask = read.table(paste0(datapath,'/rectregions.dat'), col.names=c('xcen','ycen','width','height'))
mask$x1 <- mask$xcen - 0.5*mask$width
mask$x2 <- mask$x1 + mask$width
mask$y1 <- mask$ycen - 0.5*mask$height
mask$y2 <- mask$ycen + mask$height
mask$factor <- as.character(row.names(mask))
mask$x1t <- mask$x1
mask$x1 <- mask$y1
mask$y1 <- ysize - mask$x1t
mask$x2t <- mask$x2
mask$x2 <- mask$y2
mask$y2 <- ysize - mask$x2t
outfile <- 'n4594_trimod.pdf'
galname <- 'NGC 4594 (SAa)'
galcenx <- 4411
galceny <- 4375
d <- subset(d, galcen_radius < extent)
source('mm_rad_plots.R', print.eval=TRUE)
nrpt <- data.frame(class=newrp$class, galaxy=galname, x=newrp$r/extent, sdr=newrp$sdr)
nrp <- rbind(nrp,nrpt)
bf <- rbind(bf, fits)
source('~/Dissertation/plots/color_dist/mm_rad_plots_all.R')
bf
library(flux)
install.packages('flux')
library(flux)
auc(fitlineb$r, fitlineb$pow)
auc(fitlinev$r, fitlinev$pow)
fitlinev
auc(fitlinev$r, 10^fitlinev$pow)
get_total <- function(df){
binw <- df[2,'x'] - df[1,'x']
df$area <- df$binw * 10^df$y
df$total <- cumsum(area)
reff <- approx(df$x, df$y, xout=0.5*max(df$total))
reff
}
df <- data.frame(x=fitlinev$r, y=fitlinev$pow)
get_total(df)
df2 <- data.frame(x=fitlinev$r, y=fitlinev$pow)
get_total(df)
get_total <- function(df){
binw <- df[2,'x'] - df[1,'x']
df$area <- binw * 10^df$y
df$total <- cumsum(df$area)
reff <- approx(df$x, df$y, xout=0.5*max(df$total))
reff
}
get_total(df)
View(df)
get_total <- function(df){
binw <- df[2,'x'] - df[1,'x']
df$area <- binw * 10^df$y
df$total <- cumsum(df$area)
print(max(df$total))
reff <- approx(df$x, df$y, xout=0.5*max(df$total))
reff
}
get_total(df)
get_total <- function(df){
binw <- df[2,'x'] - df[1,'x']
df$area <- binw * 10^df$y
df$total <- cumsum(df$area)
print(max(df$total))
reff <- approx(df$y, df$x, xout=0.5*max(df$total))
reff
}
get_total(df)
get_total <- function(df){
binw <- df[2,'x'] - df[1,'x']
df$area <- binw * 10^df$y
df$total <- cumsum(df$area)
print(max(df$total))
reff <- approx(df$total, df$x, xout=0.5*max(df$total))
reff
}
get_total(df)
get_total <- function(df){
binw <- df[2,'x'] - df[1,'x']
df$area <- binw * 10^df$y
df$total <- cumsum(df$area)
print(max(df$total))
reff <- approx(df$total, df$x, xout=0.5*max(df$total))
df
}
df2 <- get_total(df)
View(df2)
source('~/Dissertation/plots/color_dist/mm_rad_plots_all.R')
source('~/Dissertation/plots/color_dist/mm_rad_plots.R')
source('~/Dissertation/plots/color_dist/mm_rad_plots.R')
fits
source('~/Dissertation/plots/color_dist/mm_rad_plots.R')
fits
source('~/Dissertation/plots/color_dist/mm_rad_plots.R')
fits
source('~/Dissertation/plots/color_dist/mm_rad_plots.R')
fits
source('~/Dissertation/plots/color_dist/mm_rad_plots_all.R')
f
source('~/Dissertation/plots/color_dist/mm_rad_plots.R')
fits
reff
setwd("~/Dissertation/plots/isochrones/iso2")
source('~/Dissertation/plots/isochrones/iso2/isoBR125.R')
source('~/Dissertation/plots/isochrones/iso2/isoBR125.R')
GCS = read.csv(file="../mastertable/mastertable_gcs.csv",header=TRUE,dec=".",sep=",")
setwd("~/Dissertation/plots/SN")
GCS = read.csv(file="../mastertable/mastertable_gcs.csv",header=TRUE,dec=".",sep=",")
View(GCS)
source('~/Dissertation/plots/SN/sn.R')
df
g2
g2
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
GCS$mass
source('~/Dissertation/plots/SN/sn.R')
GCS$mass_err
GCS$T_err
GCS$T
source('~/Dissertation/plots/SN/sn.R')
GCS$M_V
max(GCS$S_N)
max(GCS$M_V)
min(GCS$M_V)
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
g1
source('~/Dissertation/plots/SN/sn.R')
g2
GCS$T+GCS$T_err
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
g1
g2
ggplot(data=GCS, aes(x=M_V, y=S_N)) + geom_point()
source('~/Dissertation/plots/SN/sn.R')
g1
g1 <- ggplot(data=GCS, aes(x=M_V, y=S_N)) +
geom_point(size=2) +
geom_errorbar(aes(x=M_V, ymin=S_N-S_N_err,ymax=S_N+S_N_err), width=0.1, size=0.2) +
geom_errorbarh(aes(xmin=M_V-M_V_err,xmax=M_V+M_V_err), height=0.1, size=0.2)
g1
g1 <- ggplot(data=GCS, aes(x=M_V, y=S_N)) +
geom_point(size=2) +
geom_errorbar(aes(x=M_V, ymin=S_N-S_N_err,ymax=S_N+S_N_err), width=0.1, size=0.2) +
geom_errorbarh(aes(xmin=M_V-M_V_err,xmax=M_V+M_V_err), height=0.1, size=0.2) +
theme_bw() +
theme(legend.position="none") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.ticks.length=unit(-0.25, "cm"),
axis.text.y=element_text(margin=margin(0,15,0,0)),
axis.text.x=element_text(margin=margin(15,0,0,0)))
g1
g1 <- ggplot(data=GCS, aes(x=M_V, y=S_N)) +
geom_point(size=2) +
geom_errorbar(aes(x=M_V, ymin=S_N-S_N_err,ymax=S_N+S_N_err), width=0.1, size=0.2) +
geom_errorbarh(aes(xmin=M_V-M_V_err,xmax=M_V+M_V_err), height=0.1, size=0.2) +
theme_bw() +
theme(legend.position="none") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.ticks.length=unit(-0.25, "cm"),
axis.text.y=element_text(margin=margin(0,15,0,0)),
axis.text.x=element_text(margin=margin(15,0,0,0))) +
#scale_x_reverse(expand = c(0,0), breaks=seq(-20,-24,-0.2), labels=insert_minor(seq(-20,-24,-1), 4)) +
#scale_y_continuous(expand = c(0,0), breaks=seq(0,10,0.5), labels=insert_minor(seq(0,10,1), 1)) +
ylab(expression(paste('Specific Frequency',(S[N])))) +
xlab(expression(M[V]^T))
g1
source('~/Dissertation/plots/SN/sn.R')
g1
source('~/Dissertation/plots/SN/sn.R')
g1
source('~/Dissertation/plots/SN/sn_test2.R')
g1
GCS = read.csv(file="../mastertable/mastertable_gcs.csv",header=TRUE,dec=".",sep=",")
GCS <- data.frame(M_V = GCS$M_V, S_N = GCS$S_N,
M_V_err = GCS$M_V_err, S_N_err = GCS$S_N_err,
mass = GCS$mass, mass_err = GCS$mass_err,
T_N = GCS$T, T_N_err = GCS$T_err,
Extent = GCS$Extent, Extent_err= GCS$Extent_err)
g1 <- ggplot(data=GCS, aes(x=M_V, y=S_N)) +
geom_point(size=2) +
geom_errorbar(aes(x=M_V, ymin=S_N-S_N_err,ymax=S_N+S_N_err), width=0.1, size=0.2) +
geom_errorbarh(aes(xmin=M_V-M_V_err,xmax=M_V+M_V_err), height=0.1, size=0.2) +
theme_bw() +
theme(legend.position="none") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.ticks.length=unit(-0.25, "cm"),
axis.text.y=element_text(margin=margin(0,15,0,0)),
axis.text.x=element_text(margin=margin(15,0,0,0))) +
#scale_x_reverse(expand = c(0,0), breaks=seq(-20,-24,-0.2), labels=insert_minor(seq(-20,-24,-1), 4)) +
#scale_y_continuous(expand = c(0,0), breaks=seq(0,10,0.5), labels=insert_minor(seq(0,10,1), 1)) +
ylab(expression(paste('Specific Frequency',(S[N])))) +
xlab(expression(M[V]^T))
g1
GCS = read.csv(file="../mastertable/mastertable_gcs.csv",header=TRUE,dec=".",sep=",")
GCS <- data.frame(M_V = GCS$M_V, S_N = GCS$S_N,
M_V_err = GCS$M_V_err, S_N_err = GCS$S_N_err,
mass = GCS$mass, mass_err = GCS$mass_err,
T_N = GCS$T, T_N_err = GCS$T_err,
Extent = GCS$Extent, Extent_err= GCS$Extent_err)
g1 <- ggplot(data=GCS, aes(x=M_V, y=S_N)) +
geom_point(size=2) +
geom_errorbar(aes(x=M_V, ymin=S_N-S_N_err,ymax=S_N+S_N_err), width=0.1, size=0.2) +
geom_errorbarh(aes(xmin=M_V-M_V_err,xmax=M_V+M_V_err), height=0.1, size=0.2) +
theme_bw() +
theme(legend.position="none") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.ticks.length=unit(-0.25, "cm"),
axis.text.y=element_text(margin=margin(0,15,0,0)),
axis.text.x=element_text(margin=margin(15,0,0,0))) +
#scale_x_reverse(expand = c(0,0), breaks=seq(-20,-24,-0.2), labels=insert_minor(seq(-20,-24,-1), 4)) +
#scale_y_continuous(expand = c(0,0), breaks=seq(0,10,0.5), labels=insert_minor(seq(0,10,1), 1)) +
ylab(expression(paste('Specific Frequency',(S[N])))) +
xlab(expression(M[V]^T))
#
g1
g1 <- ggplot(data=GCS, aes(x=M_V, y=S_N)) +
geom_point(size=2) +
geom_errorbar(aes(x=M_V, ymin=S_N-S_N_err,ymax=S_N+S_N_err), width=0.1, size=0.2) +
geom_errorbarh(aes(xmin=M_V-M_V_err,xmax=M_V+M_V_err), height=0.1, size=0.2) +
theme_bw() +
theme(legend.position="none") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.ticks.length=unit(-0.25, "cm"),
axis.text.y=element_text(margin=margin(0,15,0,0)),
axis.text.x=element_text(margin=margin(15,0,0,0)))
g1
g1 <- ggplot(data=GCS, aes(x=M_V, y=S_N)) +
geom_point(size=2) +
geom_errorbar(aes(x=M_V, ymin=S_N-S_N_err,ymax=S_N+S_N_err), width=0.1, size=0.2) +
geom_errorbarh(aes(xmin=M_V-M_V_err,xmax=M_V+M_V_err), height=0.1, size=0.2) +
theme_bw() +
theme(legend.position="none")
g1
g1 <- ggplot(data=GCS, aes(x=M_V, y=S_N)) +
geom_point(size=2)
g1
g1 <- ggplot(data=GCS, aes(x=M_V, y=S_N)) +
geom_point(size=2) +
geom_errorbar(aes(x=M_V, ymin=S_N-S_N_err,ymax=S_N+S_N_err), width=0.1, size=0.2) +
geom_errorbarh(aes(xmin=M_V-M_V_err,xmax=M_V+M_V_err), height=0.1, size=0.2) +
theme_bw()
g1
g1 <- ggplot(data=GCS, aes(x=M_V, y=S_N)) +
geom_point(size=2) +
geom_errorbar(aes(ymin=S_N-S_N_err,ymax=S_N+S_N_err), width=0.1, size=0.2) +
geom_errorbarh(aes(xmin=M_V-M_V_err,xmax=M_V+M_V_err), height=0.1, size=0.2)
g1
g1 <- ggplot(data=GCS, aes(x=M_V, y=S_N)) +
geom_point(size=2) +
geom_errorbar(aes(ymin=S_N-S_N_err,ymax=S_N+S_N_err), width=0.1, size=0.2)
g1
g1 <- ggplot(data=GCS, aes(x=M_V, y=S_N)) +
geom_point(size=2)
g1
GCS = read.csv(file="../mastertable/mastertable_gcs.csv",header=TRUE,dec=".",sep=",")
g1
g5 <- ggplot(data=GCS, aes(x=M_V, y=S_N)) +
geom_point(size=2)
g5
View(GCS)
GCS = read.csv(file="../mastertable/mastertable_gcs.csv",header=TRUE,dec=".",sep=",")
GCS <- data.frame(M_V = GCS$M_V, S_N = GCS$S_N,
M_V_err = GCS$M_V_err, S_N_err = GCS$S_N_err,
mass = GCS$mass, mass_err = GCS$mass_err,
T_N = GCS$T, T_N_err = GCS$T_err,
Extent = GCS$Extent, Extent_err= GCS$Extent_err)
g5 <- ggplot(data=GCS) +
geom_point(size=2)
g5
g5 <- ggplot(data=GCS) +
geom_point(aes(x=M_V, y=S_N), size=2)
g5
source('~/Dissertation/plots/SN/sn_test2.R')
g2
source('~/Dissertation/plots/SN/sn_test2.R')
g2
source('~/Dissertation/plots/SN/sn_test2.R')
g2
source('~/Dissertation/plots/SN/sn_test2.R')
g2
source('~/Dissertation/plots/SN/sn_test2.R')
g2
source('~/Dissertation/plots/SN/sn_test2.R')
g2
source('~/Dissertation/plots/SN/sn_test2.R')
g2
g2 <- ggplot() +
geom_point(data=GCS, aes(x=mass, y=T_N), size=2)
g2
GCS = read.csv(file="../mastertable/mastertable_gcs.csv",header=TRUE,dec=".",sep=",")
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
source('~/Dissertation/plots/SN/sn.R')
summary(df)
setwd("~/Dissertation/plots/completeness")
source('~/Dissertation/plots/completeness/completeness.R')
source('~/Dissertation/plots/completeness/completeness.R')
source('~/Dissertation/plots/completeness/completeness.R')
source('~/Dissertation/plots/completeness/completeness.R')
setwd("~/Dissertation/plots/radprof")
galname <- "NGC 4382 (S0)"
datapath <- "~/gcc/n4382/gcfinder3/"
outfile <- "n4382_radprof.pdf"
extent <- 20.5
extent_err <- 0.8
distmod <- 31.33
distmod_err <- 0.14
label1 <- 'Mosaic'
label2 <- 'HST'
source('radprof.R',print.eval=TRUE)
rp
cnames <- c("r","N","sd","sderr","lsd","lsderrhi","lsderrlo","good_frac","r_d","NGC","Ncontam","contam_frac")
rp = read.table(paste(datapath,'/corrected_profile.all.out',sep=''), col.names=cnames)
rp <- subset(rp, r < max(outer, 1.5*extent))
rp$Type <- label1
outer <- 0
rp = read.table(paste(datapath,'/corrected_profile.all.out',sep=''), col.names=cnames)
rp <- subset(rp, r < max(outer, 1.5*extent))
rp$Type <- label1
rp
extra <- read.table(paste(datapath,'/extra.radprof',sep=''), col.names=c('r','sd','sderr'))
extra$Type <- 'HST'
extra
rp2 <- merge(extra, rp)
rp2
rp2 <- data.frame(r = rp$r, sd= rp$sd, sderr = rp$sderr, Type =rp$Type)
rp3 <- merge(extra, rp2)
rp3
rp3 <- rbind(extra,rp2)
rp3
stargazer(rp3, summary=NULL)
stargazer(rp3, summary=FALSE)
stargazer(rp3, summary=FALSE, rownames = FALSE)
stargazer(rp3, summary=FALSE, rownames = FALSE, digits=2)
galname <- "NGC 4621 (E5)"
datapath <- "~/gcc/n4649/gcfinder3.n4621/"
label1 <- 'Mosaic'
cnames <- c("r","N","sd","sderr","lsd","lsderrhi","lsderrlo","good_frac","r_d","NGC","Ncontam","contam_frac")
rp = read.table(paste(datapath,'/corrected_profile.all.out',sep=''), col.names=cnames)
rp <- subset(rp, r < max(outer, 1.5*extent))
rp$Type <- label1
extra <- read.table(paste(datapath,'/extra.radprof',sep=''), col.names=c('r','sd','sderr'))
rp2 <- data.frame(r = rp$r, sd= rp$sd, sderr = rp$sderr, Type =rp$Type)
extra$Type <- 'HST'
rp3 <- rbind(extra, rp2)
rp3
stargazer(rp3, summary=FALSE, rownames = FALSE, digits=2)
galname <- "NGC 4649 (E2)"
datapath <- "~/gcc/n4649/gcfinder3.n4649/"
extra <- read.table(paste(datapath,'/extra.radprof',sep=''), col.names=c('r','sd','sderr'))
cnames <- c("r","N","sd","sderr","lsd","lsderrhi","lsderrlo","good_frac","r_d","NGC","Ncontam","contam_frac")
rp = read.table(paste(datapath,'/corrected_profile.all.out',sep=''), col.names=cnames)
rp <- subset(rp, r < max(outer, 1.5*extent))
rp$Type <- label1
extra$Type <- 'HST'
rp3 <- rbind(extra, rp2)
stargazer(rp3, summary=FALSE, rownames = FALSE, digits=2)
rp2 <- data.frame(r = rp$r, sd= rp$sd, sderr = rp$sderr, Type =rp$Type)
rp3 <- rbind(extra, rp2)
stargazer(rp3, summary=FALSE, rownames = FALSE, digits=2)
datapath <- "~/gcc/n5846/gcfinder3/"
outfile <- "n5846_radprof.pdf"
cnames <- c("r","N","sd","sderr","lsd","lsderrhi","lsderrlo","good_frac","r_d","NGC","Ncontam","contam_frac")
rp = read.table(paste(datapath,'/corrected_profile.all.out',sep=''), col.names=cnames)
rp <- subset(rp, r < max(outer, 1.5*extent))
rp$Type <- label1
rp2 <- data.frame(r = rp$r, sd= rp$sd, sderr = rp$sderr, Type =rp$Type)
extra <- read.table(paste(datapath,'/extra.radprof',sep=''), col.names=c('r','sd','sderr'))
extra$Type <- 'HST'
rp3 <- rbind(extra, rp2)
stargazer(rp3, summary=FALSE, rownames = FALSE, digits=2)
setwd("~/Dissertation/plots/feh_bvr")
mwgc <- read.table('harris_clean.txt')
mwgc
View(mwgc)
mwgc <- read.table('harris_clean.txt', header=TRUE)
mwgc1 <- subset(mwgc, X.Fe.H. < -0.8)
nrows(mwgc1)
nrow(mwgc1)
91/ 117
27 / 121
96 / 121
94 / 121
setwd("~/Dissertation/plots/color_dist")
gcc90<- read.csv('gcc90.2.csv',header=TRUE)
gcc90<- subset(gcc90, BR < 1.8)
gcc90<- subset(gcc90, BR > 0.85)
View(gcc90)
source('~/Dissertation/plots/color_dist/alldists.R')
source('~/Dissertation/plots/color_dist/alldists.R')
source('~/Dissertation/plots/color_dist/alldists.R')
g
source('~/Dissertation/plots/color_dist/alldists.R')
g
source('~/Dissertation/plots/color_dist/alldists.R')
g
source('~/Dissertation/plots/color_dist/alldists.R')
g
source('~/Dissertation/plots/color_dist/alldists.R')
source('~/Dissertation/plots/color_dist/alldists.R')
source('~/Dissertation/plots/color_dist/alldists.R')
source('~/Dissertation/plots/color_dist/alldists.R')
source('~/Dissertation/plots/color_dist/alldists.R')
source('~/Dissertation/plots/color_dist/alldists.R')
source('~/Dissertation/plots/color_dist/alldists.R')
source('~/Dissertation/plots/color_dist/alldists.R')
source('~/Dissertation/plots/color_dist/alldists.R')
source('~/Dissertation/plots/color_dist/alldists.R')
source('~/Dissertation/plots/color_dist/alldists.R')
source('~/Dissertation/plots/color_dist/alldists.R')
source('~/Dissertation/plots/color_dist/alldists.R')
source('~/Dissertation/plots/color_dist/alldists.R')
source('~/Dissertation/plots/color_dist/alldists.R')
source('~/Dissertation/plots/color_dist/alldists.R')
setwd("~/Dissertation/plots/harris_test")
source('~/Dissertation/plots/harris_test/hcatNgc.R')
source('~/Dissertation/plots/harris_test/hcatNgc.R')
g2
g2
source('~/Dissertation/plots/harris_test/hcatNgc.R')
g2
g
g
g
save(hcat, file='hcat.Robj')
View(hcat)
View(pred.NB2errx)
pred.NB2errx[pred.NB2errx$Type == 'd/Irr']$Type <- 'Irr / D'
pred.NB2errx[pred.NB2errx$Type == 'd/Irr', 'Type'] <- 'Irr / D'
pred.NB2errx['Type', pred.NB2errx$Type == 'd/Irr'] <- 'Irr / D'
pred.NB2errx[pred.NB2errx$Type == 'd/Irr',]$Type <- 'Irr / D'
pred.NB2errx$Type[pred.NB2errx$Type == 'd/Irr'] <- 'Irr / D'
pred.NB2errx$Type == 'd/Irr'
pred.NB2errx$Type[pred.NB2errx$Type == NA] <- 'Irr / D'
pred.NB2errx$Type == NA
pred.NB2errx$Type
is.na(pred.NB2errx$Type)
pred.NB2errx$Type[is.na(pred.NB2errx$Type)] <- 'Irr / D'
is.na(pred.NB2errx$Type)
pred.NB2errx[is.na(pred.NB2errx$Type)]
pred.NB2errx[is.na(pred.NB2errx$Type),"Type"]
pred.NB2errx[is.na(pred.NB2errx$Type),"Type"] <- 'Irr / D'
pred.NB2errx[is.na(pred.NB2errx$Type),"Type"] <- 'Irr/D'
pred.NB2errx[is.na(pred.NB2errx$Type),"Type"] <- 'Irr'
pred.NB2errx[is.na(pred.NB2errx$Type),"Type"] <- "Irr/D"
pred.NB2errx[is.na(pred.NB2errx$Type),"Type"] <- c("Irr/D")
pred.NB2errx[is.na(pred.NB2errx$Type),"Type"] <- as.factor("Irr/D")
pred.NB2errx[is.na(pred.NB2errx$Type),2] <- "Irr/D"
pred.NB2errx[is.na(pred.NB2errx$Type),2] <- factor(c("Irr/D"))
pred.NB2errx$Type <- as.character(pred.NB2errx$Type)
pred.NB2errx[is.na(pred.NB2errx$Type),"Type"] <- 'Irr / D'
pred.NB2errx$Type <- factor(pred.NB2errx$Type)
g <- ggplot(data=pred.NB2errx, aes(x=mean, y=NGC)) +
geom_point(aes(color=Type, shape=Type), size=1) +
geom_errorbar(aes(color=Type, ymin=NGC-NGC_err,ymax=NGC+NGC_err), size=0.2) +
geom_errorbarh(aes(color=Type, xmin=lwr1,xmax=upr1), size=0.2) +
geom_abline(aes(intercept=0, slope=1), size=0.3, linetype=2) +
#geom_point(data=pred.NB2err, aes(x=mean, y=NGC), size=1, color='black') +
#geom_errorbarh(data=pred.NB2err, aes(x=mean, y=NGC, xmin=lwr3,xmax=upr3), size=0.3, color='black') +
theme_bw() +
theme(legend.position="bottom") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.title=element_blank(),
legend.key = element_blank(),
axis.line = element_line(colour = "black"),
axis.ticks.length=unit(-0.08, "cm"),
axis.title=element_text(size=12),
axis.text.y=element_text(margin=margin(0,5,0,0), size=8),
axis.text.x=element_text(margin=margin(5,0,0,0), size=8)) +
xlab(expression(Predicted~N[GC])) +
ylab(expression(Observed~N[GC])) +
scale_y_continuous(trans='asinh',breaks=c(0,1,10,100,1000,10000,100000),labels=c("0",expression(10^0),expression(10^1),expression(10^2),expression(10^3),expression(10^4),expression(10^5)), limits=c(0,NA)) +
scale_x_continuous(trans='asinh',breaks=c(0,1,10,100,1000,10000,100000),labels=c("0",expression(10^0),expression(10^1),expression(10^2),expression(10^3),expression(10^4),expression(10^5)), limits=c(0,NA))
g
ggsave('predNgc.pdf', g, height=8, width=8)
